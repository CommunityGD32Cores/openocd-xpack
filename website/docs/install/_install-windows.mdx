
import InstallEasy from './_install-easy.md';
import InstallWindowsTree from './_install-windows-tree.mdx';
import UninstallEasy from './_uninstall-easy.md';
import InstallManual from './_install-manual.md';
import InstallManualInfo from './_install-manual-info.mdx';
import CodeBlock from '@theme/CodeBlock';

<InstallEasy is_windows={ props.is_windows }/>

<InstallWindowsTree version={ props.version } xpack_subversion={ props.xpack_subversion } npm_subversion={ props.npm_subversion }/>

No other files are installed in any system folders or other locations.

<UninstallEasy/>

### Quick test

To check if the xpm installed OpenOCD starts, use something like:

<CodeBlock language="console"> {
`C:\\> %USERPROFILE%\\AppData\\Roaming\\xPacks\\@xpack-dev-tools\\openocd\\${ props.version }-${ props.xpack_subversion }.${ props.npm_subversion }\\.content\\bin\\openocd.exe --version
${ props.version }`
}</CodeBlock>

<InstallManual/>

### Download

The Windows versions of **xPack OpenOCD**
are packed as ZIP files.
Download the latest version named like:

* <code>xpack-openocd-{ props.version }-{ props.xpack_subversion }-win32-x64.zip</code>

:::note

In case you wonder where the suffix comes
from, it is exactly the Node.js `process.platform` and `process.arch`.
The `win32` part is confusing, but we have to live with it.

:::

### Unpack

To manually install the <b>xPack OpenOCD</b>,
unpack the archive and copy it into the
<code>%USERPROFILE%\\AppData\\Roaming\\xPacks\\openocd\\xpack-openocd-{ props.version }-{ props.xpack_subversion }</code> folder
(for example <code>C:\\Users\\ilg\\AppData\\Roaming\\xPacks\\openocd\\xpack-openocd-{ props.version }-{ props.xpack_subversion }</code>);
according to Microsoft, <code>AppData\\Roaming</code> is the recommended location for
installing user specific packages.

<InstallManualInfo/>

### Quick test

To check if the manually installed OpenOCD starts, use something like:

<CodeBlock language="console"> {
`C:\\> %USERPROFILE%\\AppData\\Roaming\\xPacks\\openocd\\xpack-openocd-${ props.version }-${ props.xpack_subversion }\\bin\\openocd.exe --version
${ props.version }`
}</CodeBlock>


## Drivers

As usual on Windows, mastering drivers is a challenge and OpenOCD is no
exceptions, so don't be surprised to encounter many incompatible drivers
for various JTAG probes.

### Zadig

The OpenOCD distribution includes some libusb
drivers, and recommends to run the [`zadig.exe`](https://zadig.akeo.ie) tool to activate them.

For example
[ARM-USB-OCD](https://www.olimex.com/Products/ARM/JTAG/) from
[Olimex](https://www.olimex.com/), after installing the vendor drivers,
asks to install Zadig and convert the vendor drivers to WinUSB drivers.

:::caution

Although converting the vendor drivers
to WinUSB drivers will make OpenOCD happy, please be aware that other
tools using the original drivers will no longer work while Zadig is
active, and to make them work you need to uninstall the Zadig driver
for the device and reinstall the vendor driver (see
[Zadig FAQ](https://github.com/pbatard/libwdi/wiki/FAQ#Help_Zadig_replaced_the_driver_for_the_wrong_device_How_do_I_restore_it)).
Our
recommendation is to use Zadig only as a last resort solution, and, when
possible, prefer the manufacturer drivers.

:::

### ST-LINK

One example of compatible drivers are the ST-LINK USB drivers, from ST,
available as part number
[STSW-LINK009](https://www.st.com/web/en/catalog/tools/FM147/SC1887/PF260219).
Download the latest `stsw-link009.zip` archive, extract its content into a separate
folder, and run the `dpinst_amd64.exe` (or `dpinst_x86.exe`) with
administrative privileges.

As for most Windows drivers, to complete the installation, a restart
usually helps.

Connect the ST-LINK or the DISCOVERY board and check in **Control Panel** 
→ **System** → **Device Manager** if the JTAG is operational.

![ST-LINK Windows device](/img/windows-devices-stlink.png)

For other probes follow the manufacturer instructions.

:::note

All Windows tests were performed on Windows 11.
If, for any
reasons, you still need to use older versions, especially the venerable Windows XP,
some differences may be observed in the USB subsystem; to stay on the
safe side, try to always use original manufacturer drivers.

:::

